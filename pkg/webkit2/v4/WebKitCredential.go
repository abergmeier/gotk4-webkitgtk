// Code generated by girgen. DO NOT EDIT.

package webkit2

import (
	"fmt"
	"runtime"
	"unsafe"

	"github.com/diamondburned/gotk4/pkg/core/gextras"
	externglib "github.com/gotk3/gotk3/glib"
)

// #cgo pkg-config: webkit2gtk-4.0
// #cgo CFLAGS: -Wno-deprecated-declarations
// #include <glib-object.h>
// #include <webkit2/webkit2.h>
import "C"

func init() {
	externglib.RegisterGValueMarshalers([]externglib.TypeMarshaler{
		{T: externglib.Type(C.webkit_credential_persistence_get_type()), F: marshalCredentialPersistence},
		{T: externglib.Type(C.webkit_credential_get_type()), F: marshalCredential},
	})
}

// CredentialPersistence: enum values representing the duration for which a
// credential persists.
type CredentialPersistence int

const (
	// CredentialPersistenceNone: credential does not persist
	CredentialPersistenceNone CredentialPersistence = iota
	// CredentialPersistenceForSession: credential persists for session only
	CredentialPersistenceForSession
	// CredentialPersistencePermanent: credential persists permanently
	CredentialPersistencePermanent
)

func marshalCredentialPersistence(p uintptr) (interface{}, error) {
	return CredentialPersistence(C.g_value_get_enum((*C.GValue)(unsafe.Pointer(p)))), nil
}

// String returns the name in string for CredentialPersistence.
func (c CredentialPersistence) String() string {
	switch c {
	case CredentialPersistenceNone:
		return "None"
	case CredentialPersistenceForSession:
		return "ForSession"
	case CredentialPersistencePermanent:
		return "Permanent"
	default:
		return fmt.Sprintf("CredentialPersistence(%d)", c)
	}
}

type Credential struct {
	nocopy gextras.NoCopy
	native *C.WebKitCredential
}

func marshalCredential(p uintptr) (interface{}, error) {
	b := C.g_value_get_boxed((*C.GValue)(unsafe.Pointer(p)))
	return &Credential{native: (*C.WebKitCredential)(unsafe.Pointer(b))}, nil
}

// NewCredential constructs a struct Credential.
func NewCredential(username string, password string, persistence CredentialPersistence) *Credential {
	var _arg1 *C.gchar                      // out
	var _arg2 *C.gchar                      // out
	var _arg3 C.WebKitCredentialPersistence // out
	var _cret *C.WebKitCredential           // in

	_arg1 = (*C.gchar)(unsafe.Pointer(C.CString(username)))
	_arg2 = (*C.gchar)(unsafe.Pointer(C.CString(password)))
	_arg3 = C.WebKitCredentialPersistence(persistence)

	_cret = C.webkit_credential_new(_arg1, _arg2, _arg3)

	var _credential *Credential // out

	_credential = (*Credential)(gextras.NewStructNative(unsafe.Pointer(_cret)))
	runtime.SetFinalizer(_credential, func(v *Credential) {
		C.webkit_credential_free((*C.WebKitCredential)(gextras.StructNative(unsafe.Pointer(v))))
	})

	return _credential
}

// Copy: make a copy of the KitCredential.
func (credential *Credential) Copy() *Credential {
	var _arg0 *C.WebKitCredential // out
	var _cret *C.WebKitCredential // in

	_arg0 = (*C.WebKitCredential)(gextras.StructNative(unsafe.Pointer(credential)))

	_cret = C.webkit_credential_copy(_arg0)

	var _ret *Credential // out

	_ret = (*Credential)(gextras.NewStructNative(unsafe.Pointer(_cret)))
	runtime.SetFinalizer(_ret, func(v *Credential) {
		C.webkit_credential_free((*C.WebKitCredential)(gextras.StructNative(unsafe.Pointer(v))))
	})

	return _ret
}

// Free: free the KitCredential.
func (credential *Credential) free() {
	var _arg0 *C.WebKitCredential // out

	_arg0 = (*C.WebKitCredential)(gextras.StructNative(unsafe.Pointer(credential)))

	C.webkit_credential_free(_arg0)
}

// Password: get the password currently held by this KitCredential.
func (credential *Credential) Password() string {
	var _arg0 *C.WebKitCredential // out
	var _cret *C.gchar            // in

	_arg0 = (*C.WebKitCredential)(gextras.StructNative(unsafe.Pointer(credential)))

	_cret = C.webkit_credential_get_password(_arg0)

	var _utf8 string // out

	_utf8 = C.GoString((*C.gchar)(unsafe.Pointer(_cret)))

	return _utf8
}

// Persistence: get the persistence mode currently held by this KitCredential.
func (credential *Credential) Persistence() CredentialPersistence {
	var _arg0 *C.WebKitCredential           // out
	var _cret C.WebKitCredentialPersistence // in

	_arg0 = (*C.WebKitCredential)(gextras.StructNative(unsafe.Pointer(credential)))

	_cret = C.webkit_credential_get_persistence(_arg0)

	var _credentialPersistence CredentialPersistence // out

	_credentialPersistence = CredentialPersistence(_cret)

	return _credentialPersistence
}

// Username: get the username currently held by this KitCredential.
func (credential *Credential) Username() string {
	var _arg0 *C.WebKitCredential // out
	var _cret *C.gchar            // in

	_arg0 = (*C.WebKitCredential)(gextras.StructNative(unsafe.Pointer(credential)))

	_cret = C.webkit_credential_get_username(_arg0)

	var _utf8 string // out

	_utf8 = C.GoString((*C.gchar)(unsafe.Pointer(_cret)))

	return _utf8
}

// HasPassword: determine whether this credential has a password stored.
func (credential *Credential) HasPassword() bool {
	var _arg0 *C.WebKitCredential // out
	var _cret C.gboolean          // in

	_arg0 = (*C.WebKitCredential)(gextras.StructNative(unsafe.Pointer(credential)))

	_cret = C.webkit_credential_has_password(_arg0)

	var _ok bool // out

	if _cret != 0 {
		_ok = true
	}

	return _ok
}
